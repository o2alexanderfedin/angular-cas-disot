var xe=Object.create;var R=Object.defineProperty,ge=Object.defineProperties,ye=Object.getOwnPropertyDescriptor,ve=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertyNames,q=Object.getOwnPropertySymbols,ne=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,Ce=Reflect.get;var I=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),Ee=t=>{throw TypeError(t)};var re=(t,e,r)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,P=(t,e)=>{for(var r in e||={})J.call(e,r)&&re(t,r,e[r]);if(q)for(var r of q(e))oe.call(e,r)&&re(t,r,e[r]);return t},vt=(t,e)=>ge(t,ve(e));var mt=(t,e)=>{var r={};for(var n in t)J.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&q)for(var n of q(t))e.indexOf(n)<0&&oe.call(t,n)&&(r[n]=t[n]);return r};var Ct=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),L=(t,e)=>{for(var r in e)R(t,r,{get:e[r],enumerable:!0})},Se=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of me(e))!J.call(t,o)&&o!==r&&R(t,o,{get:()=>e[o],enumerable:!(n=ye(e,o))||n.enumerable});return t};var Et=(t,e,r)=>(r=t!=null?xe(ne(t)):{},Se(e||!t||!t.__esModule?R(r,"default",{value:t,enumerable:!0}):r,t));var St=(t,e,r)=>Ce(ne(t),r,e);var At=(t,e,r)=>new Promise((n,o)=>{var i=c=>{try{a(r.next(c))}catch(f){o(f)}},s=c=>{try{a(r.throw(c))}catch(f){o(f)}},a=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,s);a((r=r.apply(t,e)).next())}),ie=function(t,e){this[0]=t,this[1]=e},zt=(t,e,r)=>{var n=(s,a,c,f)=>{try{var m=r[s](a),D=(a=m.value)instanceof ie,U=m.done;Promise.resolve(D?a[0]:a).then(b=>D?n(s==="return"?s:"next",a[1]?{done:b.done,value:b.value}:b,c,f):c({value:b,done:U})).catch(b=>n("throw",b,c,f))}catch(b){f(b)}},o=s=>i[s]=a=>new Promise((c,f)=>n(s,a,c,f)),i={};return r=r.apply(t,e),i[I("asyncIterator")]=()=>i,o("next"),o("throw"),o("return"),i},Dt=t=>{var e=t[I("asyncIterator")],r=!1,n,o={};return e==null?(e=t[I("iterator")](),n=i=>o[i]=s=>e[i](s)):(e=e.call(t),n=i=>o[i]=s=>{if(r){if(r=!1,i==="throw")throw s;return s}return r=!0,{done:!1,value:new ie(new Promise(a=>{var c=e[i](s);c instanceof Object||Ee("Object expected"),a(c)}),1)}}),o[I("iterator")]=()=>o,n("next"),"throw"in e?n("throw"):o.throw=i=>{throw i},"return"in e&&n("return"),o},Ut=(t,e,r)=>(e=t[I("asyncIterator")])?e.call(t):(t=t[I("iterator")](),e={},r=(n,o)=>(o=t[n])&&(e[n]=i=>new Promise((s,a,c)=>(i=o.call(t,i),c=i.done,Promise.resolve(i.value).then(f=>s({value:f,done:c}),a)))),r("next"),r("return"),e);var Qe={};L(Qe,{base32:()=>N,base32hex:()=>qe,base32hexpad:()=>Je,base32hexpadupper:()=>Pe,base32hexupper:()=>Re,base32pad:()=>ke,base32padupper:()=>Fe,base32upper:()=>$e,base32z:()=>je});var Me={};L(Me,{coerce:()=>A,empty:()=>se,equals:()=>j,fromHex:()=>ze,fromString:()=>Ue,isBinary:()=>De,toHex:()=>Ae,toString:()=>Ie});var se=new Uint8Array(0);function Ae(t){return t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),"")}function ze(t){let e=t.match(/../g);return e!=null?new Uint8Array(e.map(r=>parseInt(r,16))):se}function j(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function A(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function De(t){return t instanceof ArrayBuffer||ArrayBuffer.isView(t)}function Ue(t){return new TextEncoder().encode(t)}function Ie(t){return new TextDecoder().decode(t)}function Ne(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<t.length;o++){var i=t.charAt(o),s=i.charCodeAt(0);if(r[s]!==255)throw new TypeError(i+" is ambiguous");r[s]=o}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),m=Math.log(256)/Math.log(a);function D(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var h=0,S=0,u=0,w=d.length;u!==w&&d[u]===0;)u++,h++;for(var x=(w-u)*m+1>>>0,p=new Uint8Array(x);u!==w;){for(var g=d[u],E=0,l=x-1;(g!==0||E<S)&&l!==-1;l--,E++)g+=256*p[l]>>>0,p[l]=g%a>>>0,g=g/a>>>0;if(g!==0)throw new Error("Non-zero carry");S=E,u++}for(var C=x-S;C!==x&&p[C]===0;)C++;for(var F=c.repeat(h);C<x;++C)F+=t.charAt(p[C]);return F}function U(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var h=0;if(d[h]!==" "){for(var S=0,u=0;d[h]===c;)S++,h++;for(var w=(d.length-h)*f+1>>>0,x=new Uint8Array(w);d[h];){var p=r[d.charCodeAt(h)];if(p===255)return;for(var g=0,E=w-1;(p!==0||g<u)&&E!==-1;E--,g++)p+=a*x[E]>>>0,x[E]=p%256>>>0,p=p/256>>>0;if(p!==0)throw new Error("Non-zero carry");u=g,h++}if(d[h]!==" "){for(var l=w-u;l!==w&&x[l]===0;)l++;for(var C=new Uint8Array(S+(w-l)),F=S;l!==w;)C[F++]=x[l++];return C}}}function b(d){var h=U(d);if(h)return h;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:U,decode:b}}var Oe=Ne,Ve=Oe,ae=Ve;var Q=class{name;prefix;baseEncode;constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},X=class{name;prefix;baseDecode;prefixCodePoint;constructor(e,r,n){this.name=e,this.prefix=r;let o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ce(this,e)}},G=class{decoders;constructor(e){this.decoders=e}or(e){return ce(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function ce(t,e){return new G(P(P({},t.decoders??{[t.prefix]:t}),e.decoders??{[e.prefix]:e}))}var K=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,r,n,o){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Q(e,r,n),this.decoder=new X(e,r,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function de({name:t,prefix:e,encode:r,decode:n}){return new K(t,e,r,n)}function M({name:t,prefix:e,alphabet:r}){let{encode:n,decode:o}=ae(r,t);return de({prefix:e,name:t,encode:n,decode:i=>A(o(i))})}function Le(t,e,r,n){let o=t.length;for(;t[o-1]==="=";)--o;let i=new Uint8Array(o*r/8|0),s=0,a=0,c=0;for(let f=0;f<o;++f){let m=e[t[f]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<r|m,s+=r,s>=8&&(s-=8,i[c++]=255&a>>s)}if(s>=r||(255&a<<8-s)!==0)throw new SyntaxError("Unexpected end of data");return i}function Te(t,e,r){let n=e[e.length-1]==="=",o=(1<<r)-1,i="",s=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],s+=8;s>r;)s-=r,i+=e[o&a>>s];if(s!==0&&(i+=e[o&a<<r-s]),n)for(;(i.length*r&7)!==0;)i+="=";return i}function Be(t){let e={};for(let r=0;r<t.length;++r)e[t[r]]=r;return e}function y({name:t,prefix:e,bitsPerChar:r,alphabet:n}){let o=Be(n);return de({prefix:e,name:t,encode(i){return Te(i,n,r)},decode(i){return Le(i,o,r,t)}})}var N=y({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$e=y({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),ke=y({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fe=y({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qe=y({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Re=y({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Je=y({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Pe=y({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),je=y({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ge={};L(Ge,{base36:()=>T,base36upper:()=>Xe});var T=M({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Xe=M({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var We={};L(We,{base58btc:()=>v,base58flickr:()=>Ke});var v=M({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ke=M({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var le={};L(le,{Digest:()=>z,create:()=>Z,decode:()=>H,equals:()=>Y,hasCode:()=>lt});var Ze=pe,fe=128,He=127,Ye=~He,_e=Math.pow(2,31);function pe(t,e,r){e=e||[],r=r||0;for(var n=r;t>=_e;)e[r++]=t&255|fe,t/=128;for(;t&Ye;)e[r++]=t&255|fe,t>>>=7;return e[r]=t|0,pe.bytes=r-n+1,e}var et=W,tt=128,he=127;function W(t,n){var r=0,n=n||0,o=0,i=n,s,a=t.length;do{if(i>=a)throw W.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=o<28?(s&he)<<o:(s&he)*Math.pow(2,o),o+=7}while(s>=tt);return W.bytes=i-n,r}var rt=Math.pow(2,7),nt=Math.pow(2,14),ot=Math.pow(2,21),it=Math.pow(2,28),st=Math.pow(2,35),at=Math.pow(2,42),ct=Math.pow(2,49),dt=Math.pow(2,56),ft=Math.pow(2,63),ht=function(t){return t<rt?1:t<nt?2:t<ot?3:t<it?4:t<st?5:t<at?6:t<ct?7:t<dt?8:t<ft?9:10},pt={encode:Ze,decode:et,encodingLength:ht},ut=pt,B=ut;function $(t,e=0){return[B.decode(t,e),B.decode.bytes]}function O(t,e,r=0){return B.encode(t,e,r),e}function V(t){return B.encodingLength(t)}function Z(t,e){let r=e.byteLength,n=V(t),o=n+V(r),i=new Uint8Array(o+r);return O(t,i,0),O(r,i,n),i.set(e,o),new z(t,r,e,i)}function H(t){let e=A(t),[r,n]=$(e),[o,i]=$(e.subarray(n)),s=e.subarray(n+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new z(r,o,s,e)}function Y(t,e){if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&j(t.bytes,r.bytes)}}var z=class{code;size;digest;bytes;constructor(e,r,n,o){this.code=e,this.size=r,this.digest=n,this.bytes=o}};function lt(t,e){return t.code===e}function _(t,e){let{bytes:r,version:n}=t;switch(n){case 0:return wt(r,ee(t),e??v.encoder);default:return xt(r,ee(t),e??N.encoder)}}function Qt(t){return{"/":_(t)}}function Xt(t){return te.parse(t["/"])}var be=new WeakMap;function ee(t){let e=be.get(t);if(e==null){let r=new Map;return be.set(t,r),r}return e}var te=class t{code;version;multihash;bytes;"/";constructor(e,r,n,o){this.code=r,this.version=e,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==k)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==gt)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Z(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n!=null&&e.code===n.code&&e.version===n.version&&Y(e.multihash,n.multihash)}toString(e){return _(this,e)}toJSON(){return{"/":_(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:i,bytes:s}=r;return new t(n,o,i,s??we(n,o,i.bytes))}else if(r[yt]===!0){let{version:n,multihash:o,code:i}=r,s=H(o);return t.create(n,i,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==k)throw new Error(`Version 0 CID must use dag-pb (code: ${k}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let o=we(e,r,n.bytes);return new t(e,r,n,o)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,k,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,o=A(e.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=o.subarray(r.multihashSize-r.digestSize),s=new z(r.multihashCode,r.digestSize,i,o);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[D,U]=$(e.subarray(r));return r+=U,D},o=n(),i=k;if(o===18?(o=0,r=0):i=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let s=r,a=n(),c=n(),f=r+c,m=f-s;return{version:o,codec:i,multihashCode:a,digestSize:c,multihashSize:m,size:f}}static parse(e,r){let[n,o]=bt(e,r),i=t.decode(o);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return ee(i).set(n,e),i}};function bt(t,e){switch(t[0]){case"Q":{let r=e??v;return[v.prefix,r.decode(`${v.prefix}${t}`)]}case v.prefix:{let r=e??v;return[v.prefix,r.decode(t)]}case N.prefix:{let r=e??N;return[N.prefix,r.decode(t)]}case T.prefix:{let r=e??T;return[T.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}}function wt(t,e,r){let{prefix:n}=r;if(n!==v.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=e.get(n);if(o==null){let i=r.encode(t).slice(1);return e.set(n,i),i}else return o}function xt(t,e,r){let{prefix:n}=r,o=e.get(n);if(o==null){let i=r.encode(t);return e.set(n,i),i}else return o}var k=112,gt=18;function we(t,e,r){let n=V(t),o=n+V(e),i=new Uint8Array(o+r.byteLength);return O(t,i,0),O(e,i,n),i.set(r,o),i}var yt=Symbol.for("@ipld/js-cid/CID");export{P as a,vt as b,mt as c,Ct as d,L as e,Et as f,St as g,At as h,ie as i,zt as j,Dt as k,Ut as l,A as m,Ue as n,Ie as o,Me as p,de as q,M as r,y as s,N as t,$e as u,Qe as v,v as w,We as x,T as y,Ge as z,Z as A,H as B,le as C,_ as D,Qt as E,Xt as F,te as G};
